{% extends "admin_module/basetwo.html" %}
{% load crispy_forms_tags %}
{% load widget_tweaks %}
{% block content %}
{% load static %}
<div class="container mt-2 mb-2">
    <div class="row">
        <div class="col-lg-12 my-auto">
            <p class="p mt-2" style="font-weight: 300;">Result details of {{username}}!
            </p>
        </div>
        <div class="col-lg-12 d-flex">
            <h3 style="font-weight: 700;">{{title}}</h3>
            <a href="javascript:history.back()" class="btn btn-transparent ms-auto"><u>Go back</u></a>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <div class="d-flex justify-content-center mt-4">
                <img src="{% static 'login_module/img/submission.svg' %}" style="height: 400px;"
                     class="rounded img-fluid"
                     alt="">
            </div>
        </div>
    </div>
    <div class="row pt-5">
        <div class="col-lg-6">
            <div class="row">
                <div class="col-lg-12">
                    <div>
                        {% for detail in resultdetails|slice:"1" %}
                        <h3>
                            {{ detail.problem }}
                        </h3>
                        <input type="hidden" name="code" value="{{ detail.code }}">
                        {% endfor %}
                        <div class="col-lg-12">
                            <p>Code:</p>
                            <textarea class="p-3" id="samplecompiler"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="col-lg-12">
                <h4>
                    Details:
                </h4>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    {% for detail in resultdetails|slice:"1" %}
                    <div class="border p-4" style=" border-radius: 5px;">
                        <h4>Testcase 1:</h4>
                        <h6>Time taken: {{ detail.testcaseonetime}} sec</h6>
                        <h6>Memory: {{ detail.testcaseonememory}} Bytes </h6>
                        <div class="d-flex">
                            <h6>Expected output:</h6>
                            <h6 class="ms-1">{{ detail.problem.problemtestcaseoneoutput }}</h6>
                        </div>
                        <div class="d-flex">
                            {% if detail.useroutputonestatus_id == 1 %}
                            <h6 style="color: green;">Actual output:</h6>
                            <h6 class="ms-1" style="color: green;">{{ detail.useroutputone }}</h6>
                            <h6 class="ms-2 py-1 px-2"
                                style="color: green; border-radius: 5px; background-color: lightgreen;">
                                {{detail.useroutputonestatus}}
                            </h6>
                            {% endif %}
                            {% if detail.useroutputonestatus_id == 2 %}
                            <h6 style="color: red;">Actual output:</h6>
                            <h6 class="ms-1" style="color: red;">{{ detail.useroutputone }}</h6>
                            <div>
                                <h6 class="ms-2 px-2 py-1"
                                    style="color: red; border-radius: 5px; background-color: lightsalmon;">
                                    {{detail.useroutputonestatus}}
                                </h6>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="col-lg-6">
                    {% for detail in resultdetails|slice:"1" %}
                    <div class="border p-4" style=" border-radius: 5px;">
                        <h4>Testcase 2:</h4>
                        <h6>Time taken: {{ detail.testcasetwotime}} sec</h6>
                        <h6>Memory: {{ detail.testcasetwomemory}} </h6>
                        <div class="d-flex">
                            <h6>Expected output:</h6>
                            <h6 class="ms-1">{{ detail.problem.problemtestcasetwooutput }}</h6>
                        </div>
                        <div class="d-flex">
                            {% if detail.useroutputtwostatus_id == 1 %}
                            <h6 style="color: green;">Actual output:</h6>
                            <h6 class="ms-1" style="color: green;">{{ detail.useroutputtwo }}</h6>
                            <h6 class="ms-2 py-1 px-2"
                                style="color: green; border-radius: 5px; background-color: lightgreen;">
                                {{detail.useroutputtwostatus}}
                            </h6>
                            {% endif %}
                            {% if detail.useroutputtwostatus_id == 2 %}
                            <h6 style="color: red;">Actual output:</h6>
                            <h6 class="ms-1" style="color: red;">{{ detail.useroutputtwo }}</h6>
                            <div>
                                <h6 class="ms-2 px-2 py-1"
                                    style="color: red; border-radius: 5px; background-color: lightsalmon;">
                                    {{detail.useroutputtwostatus}}
                                </h6>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="col-lg-12 mt-3">
                    {% for detail in resultdetails|slice:"1" %}
                    <div class="border p-4" style=" border-radius: 5px;">
                        <h4>Testcase 3:</h4>
                        <h6>Time taken: {{ detail.testcasethreetime}} sec</h6>
                        <h6>Memory: {{ detail.testcasethreememory}} </h6>
                        <div class="d-flex">
                            <h6>Expected output:</h6>
                            <h6 class="ms-1">{{ detail.problem.problemtestcasethreeoutput }}</h6>
                        </div>
                        <div class="d-flex">
                            {% if detail.useroutputthreestatus_id == 1 %}
                            <h6 style="color: green;">Actual output:</h6>
                            <h6 class="ms-1" style="color: green;">{{ detail.useroutputthree }}</h6>
                            <h6 class="ms-2 py-1 px-2"
                                style="color: green; border-radius: 5px; background-color: lightgreen;">
                                {{detail.useroutputthreestatus}}
                            </h6>
                            {% endif %}
                            {% if detail.useroutputthreestatus_id == 2 %}
                            <h6 style="color: red;">Actual output:</h6>
                            <h6 class="ms-1" style="color: red;">{{ detail.useroutputthree }}</h6>
                            <div>
                                <h6 class="ms-2 px-2 py-1"
                                    style="color: red; border-radius: 5px; background-color: lightsalmon;">
                                    {{detail.useroutputthreestatus}}
                                </h6>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="col-lg-12 mt-3">
                    <div class="border p-2" style="border-radius: 5px;">
                        <h5>Score accquired: {{ detail.score }}/{{ detail.problem.score }}</h5>
                    </div>
                </div>
                {% empty %}
                <h5>No submissions</h5>
                {% endfor %}
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <div class="d-flex justify-content-center mt-4">
                <img src="{% static 'login_module/img/pair.svg' %}" style="height: 400px;"
                     class="rounded img-fluid"
                     alt="">
            </div>
        </div>
    </div>
</div>


<script>
    var editor = CodeMirror.fromTextArea(document.getElementById("samplecompiler"), {
        lineNumbers: true,
        mode: "python",
        matchBrackets: true,
        lineWrapping: true,
        autoCloseBrackets: true,
        extraKeys: {
            "Ctrl-Space": "autocomplete"
        }
    });

    code = $("input[name=code]").val();
    console.log(code)
    editor.setValue(code);

    editor.on("beforeChange", function (_, change) {
        if (change.origin == "paste") change.cancel()
    })
</script>
{% endblock content %}
